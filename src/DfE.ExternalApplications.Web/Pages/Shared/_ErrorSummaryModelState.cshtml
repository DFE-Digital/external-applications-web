@* Renders GOV.UK error summary from ModelState with anchors to inputs when possible *@
@if (!ViewData.ModelState.IsValid && ViewData.ModelState.Values.Any(v => v.Errors.Count > 0))
{
    <div class="govuk-error-summary" data-module="govuk-error-summary">
        <div role="alert">
            <h2 class="govuk-error-summary__title">There is a problem</h2>
            <div class="govuk-error-summary__body">
                <ul class="govuk-list govuk-error-summary__list">
                    @foreach (var state in ViewData.ModelState)
                    {
                        // Attempt to map model key -> element id by convention (id="{key}")
                        var key = state.Key;
                        var anchorId = string.IsNullOrWhiteSpace(key) ? null : key;
                        foreach (var err in state.Value.Errors)
                        {
                            if (!string.IsNullOrWhiteSpace(anchorId))
                            {
                                <li><a href="#@anchorId">@err.ErrorMessage</a></li>
                            }
                            else
                            {
                                <li>@err.ErrorMessage</li>
                            }
                        }
                    }
                </ul>
            </div>
        </div>
    </div>
}


